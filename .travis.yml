language: python
python:
    - "2.7"
env:
    - CKANVERSION=master
    - CKANVERSION=2.8
install:
    - bash bin/travis-build.bash
services:
    -postgresql
script: sh bin/travis-run.sh
after_success: coveralls
sudo: required

# additional jobs
matrix:
  include:
    - name: "Flake8 on Python 2.7"
      dist: xenial    # required for Python 3.7
      cache: pip
      install: pip install flake8
      script:
        - flake8 --version
        - flake8 . --count --max-complexity=13 --max-line-length=127 --statistics --exclude ckan,{{ project }}
      python: 2.7
      # overwrite matrix
      env:
        - FLAKE8=true
        - CKANVERSION=master
